#!/usr/bin/env python3
import contrib
import time

rc = contrib.RaftClient()
rc.set_host('127.0.0.1')
rc.set_port(8081)
rc.ws_start()

def report(subject,json):
    print("{} Event: {}".format(subject, json))

time.sleep(1)
rc.subscribe('kv', lambda json: report('KV', json))
rc.subscribe('mring', lambda json: report('MRing', json))

while True:
    time.sleep(1)
